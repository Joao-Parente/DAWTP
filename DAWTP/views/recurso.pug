extends layoutUser

block scripts

  link(rel='stylesheet' href='/stylesheets/style.css')
  link(rel='stylesheet' href='/stylesheets/jquery.modal.min.css')

  script( src='/javascripts/preview.js')
  script( src='/javascripts/jquery-3.5.1.min.js')
  script( src='/javascripts/jquery.modal.min.js')

block addmetadata

  .w3-dropdown-hover.w3-mobile
    button.w3-button Operações 
      i.fa.fa-caret-down

    .w3-dropdown-content.w3-bar-block.w3-dark-grey
      a.w3-bar-item.w3-button.w3-mobile(href="/publicacoes/"+recurso.id) Posts do Recurso
      a.w3-bar-item.w3-button.w3-mobile(href="/publicacoes/"+recurso.id+'/novo') Novo Post
      a.w3-bar-item.w3-button.w3-mobile(href="/recursos/download/"+recurso.id) Download
      if(user.nivel>1 || recurso.produtor==user._id)
        a.w3-bar-item.w3-button.w3-mobile(href="/recursos/delete/"+recurso.id) Delete Recurso
        a.w3-bar-item.w3-button.w3-mobile(href="/recursos/editar/"+recurso.id) Edit Recurso




block content

  .w3-stretch(id="display")

  .w3-card-4
    header.w3-container.w3-light-grey
      h3.w3-left Recurso: #{recurso.titulo} 

    .w3-container 
      table.w3-table-all
        tr 
          th Titulo
          th Subtitulo
          th DataCriação
          th DataRegisto 
          th Publicador
          th Likes 
          th Hashtags

        tr
          td=recurso.titulo
          td=recurso.subtitulo
          td=recurso.dataCriacao
          td=recurso.dataRegisto
          td=recurso.produtor
          td=recurso.likes.length
          td=recurso.hashtags



    if manifesto.pasta_rec.length > 0


      .w3-container 
        footer.w3-container.w3-light-grey
          p Pastas
        .w3-container  
          table.w3-table-all
            tr 
              th Nome

            each p in manifesto.pasta_rec
              tr
                td
                  a(href='/recursos/'+download+"/"+p.nome) #{p.nome} 
                td
                  a(href='/recursos/download/'+download+"/"+p.nome) Download


    else 
      .w3-container 
        footer.w3-container.w3-light-grey
          p Pastas
        .w3-container
          p Não há pastas....

    if manifesto.ficheiros.length > 0
      .w3-container 

        footer.w3-container.w3-light-grey

          p Ficheiros

        .w3-container 
          table.w3-table-all
            tr 
              th Titulo
              th Tipo
              th Meta


            each s in manifesto.ficheiros
              tr(onclick=`preview("${s.tipo}","${s.nome}","/${path_g}/${s.nome}","/recursos/download/${download}/${s.nome}");`)

                td=s.nome
                td=s.tipo
                td=s.subtitulo
                if  s.meta.length > 0

                  td  
                    table.w3-table-all
                      tr
                        th Nome Parametro
                        th Valor Parametro

                      each meta in s.meta
                        tr
                          td=meta.nome
                          td=meta.valor
                else
                  td Este ficheiro não tem metadata associada...




    else
      .w3-container 
        footer.w3-container.w3-light-grey
          p Ficheiros
        .w3-container
          p Não há ficheiros....


    a(href='/recursos/like/'+download) 
      img.w3-circle.w3-margin-top(src="/images/like.png" alt="Avatar" style="width:2%;border-style: solid;" )
